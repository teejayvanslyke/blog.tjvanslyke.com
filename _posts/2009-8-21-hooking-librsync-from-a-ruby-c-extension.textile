--- 
layout: post
title: Hooking librsync from a Ruby C extension
---
Despite how straightforward the solution was, I had difficulty getting the Makefile generated by @extconf.rb@ to properly include and link librsync.  Here's what I had to do in my @extconf.rb@:

{% highlight ruby %}
extension_name = 'my-ruby-thingy' 
find_header('librsync.h', '/usr/local/include') 
find_library("rsync", nil, "/usr/local/lib") 
create_makefile(extension_name)                              
{% endhighlight %}

Turns out if you supply @find_library@ with a @nil@ second argument, it looks for @main()@, which succeeds.  If you're running a MacPorts version of librsync, you'll likely need to append additional search paths (@/opt/local/include@ and @/opt/local/lib@, most likely).

